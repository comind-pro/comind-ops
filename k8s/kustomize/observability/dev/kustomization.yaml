apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: argocd

resources:
  - ../prometheus-app.yaml
  - ../loki-app.yaml
  - ../promtail-app.yaml
  - ../grafana-app.yaml

commonLabels:
  environment: dev
  managed-by: argocd

# Patches for development environment
patches:
  # Prometheus - use dev values
  - target:
      kind: Application
      name: prometheus
    patch: |-
      - op: replace
        path: /spec/source/helm/valueFiles
        value:
          - values.yaml
          - values-dev.yaml
  
  # Loki - use dev values
  - target:
      kind: Application
      name: loki
    patch: |-
      - op: replace
        path: /spec/source/helm/valueFiles
        value:
          - values.yaml
          - values-dev.yaml
  
  # Grafana - use dev values
  - target:
      kind: Application
      name: grafana
    patch: |-
      - op: replace
        path: /spec/source/helm/valueFiles
        value:
          - values.yaml
          - values-dev.yaml

