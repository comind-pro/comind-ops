loki:
  # Deployment mode: single binary for simplicity
  deploymentMode: SingleBinary
  
  loki:
    # Authentication
    auth_enabled: false
    
    # Common configuration
    commonConfig:
      replication_factor: 1
    
    # Storage configuration
    storage:
      type: filesystem
    
    # Schema configuration
    schemaConfig:
      configs:
        - from: 2024-01-01
          store: tsdb
          object_store: filesystem
          schema: v13
          index:
            prefix: index_
            period: 24h
    
    # Limits
    limits_config:
      retention_period: 720h  # 30 days
      enforce_metric_name: false
      reject_old_samples: true
      reject_old_samples_max_age: 168h
      ingestion_rate_mb: 10
      ingestion_burst_size_mb: 20
      max_cache_freshness_per_query: 10m
      split_queries_by_interval: 15m
    
    # Server configuration
    server:
      http_listen_port: 3100
      grpc_listen_port: 9095
      log_level: info
  
  # Single binary deployment
  singleBinary:
    replicas: 1
    
    # Resources
    resources:
      requests:
        cpu: 200m
        memory: 512Mi
      limits:
        cpu: 1000m
        memory: 2Gi
    
    # Persistence for logs and indexes
    persistence:
      enabled: true
      size: 50Gi
      accessModes:
        - ReadWriteOnce
      # storageClassName: standard
    
    # Extra volumes for separate data paths
    extraVolumes:
      - name: loki-chunks
        persistentVolumeClaim:
          claimName: loki-chunks
    
    extraVolumeMounts:
      - name: loki-chunks
        mountPath: /var/loki/chunks
    
    # Security context
    securityContext:
      runAsNonRoot: true
      runAsUser: 10001
      fsGroup: 10001
      seccompProfile:
        type: RuntimeDefault
  
  # Monitoring
  monitoring:
    serviceMonitor:
      enabled: true
      labels:
        release: prometheus
    
    selfMonitoring:
      enabled: false
      grafanaAgent:
        installOperator: false
  
  # Disable components not needed in single binary mode
  backend:
    replicas: 0
  read:
    replicas: 0
  write:
    replicas: 0
  
  # Gateway (nginx)
  gateway:
    enabled: true
    replicas: 1
    
    resources:
      requests:
        cpu: 50m
        memory: 64Mi
      limits:
        cpu: 200m
        memory: 128Mi
    
    ingress:
      enabled: false
  
  # Test pods
  test:
    enabled: false


