# ArgoCD Helm Chart Values Template
# This template is used for both local and AWS environments

global:
  domain: ${domain}

# Multi-environment configuration
multiEnvironment: ${multi_environment}
environments: ${environments}
namespacePrefix: ${namespace_prefix}

configs:
  params:
    server.insecure: false
  cm:
    url: https://${domain}
    application.instanceLabelKey: argocd.argoproj.io/instance
    # Repository configuration (supports both private and public)
    repositories: |
      - url: ${repo_url}
        name: ${repo_name}
        type: git
        insecure: false
        # Repository credentials will be provided via secret for private repos

server:
  ingress:
    enabled: true
    ingressClassName: nginx
    annotations:
      kubernetes.io/ingress.class: nginx
      nginx.ingress.kubernetes.io/backend-protocol: HTTPS
      nginx.ingress.kubernetes.io/force-ssl-redirect: "true"
      nginx.ingress.kubernetes.io/ssl-passthrough: "true"
    hosts:
      - ${domain}
    paths:
      - /
    pathType: Prefix
    tls:
      - hosts:
          - ${domain}
        secretName: argocd-ingress-tls
  service:
    type: ClusterIP
  extraArgs:
    - --insecure

repoServer:
  service:
    type: ClusterIP

controller:
  service:
    type: ClusterIP

dex:
  enabled: false

redis:
  enabled: true

# Repository server configuration (supports both private and public repos)
repoServer:
  service:
    type: ClusterIP
  # Mount SSH keys for private repository access (conditional)
  volumes: ${repo_server_volumes}
  volumeMounts: ${repo_server_volume_mounts}

# Controller configuration
controller:
  service:
    type: ClusterIP
  # Repository server configuration
  env:
    - name: ARGOCD_REPO_SERVER
      value: argocd-repo-server:8081
